#网络通信

通过物理链路实现数据传输共享。

# ip地址

生活中的地址指的就是，找到某人或某机关或与其通信的指定地点。在网络编程中，如果一台主机想和另一台主机进行沟通和共享数据，首先要做的第一件事情就是要找到对方。在互联网通信中，我们使用IP地址来查询到各个主机。

**ip地址：用来在网络中标记一台电脑，比如192.168.1.1；在本地局域网上是唯一的。**

## ip地址的分类

每一个IP地址包括两部分：网络地址和主机地址。IP地址通常由点分十进制(例如：192.168.1.1)的方式来表示,IP地址要和子网掩码(用来区分网络位和主机位)配合使用。

### A类地址

一个A类IP地址由1字节的网络地址和3字节主机地址组成，网络地址的最高位必须是“0”，

地址范围：1.0.0.1-126.255.255.254

子网掩码：255.0.0.0

二进制表示为：00000001 00000000 00000000 00000001 - 01111110 11111111 11111111 11111110

可用的A类网络有126个，每个网络能容纳1677214个主机

### B类地址

一个B类IP地址由2个字节的网络地址和2个字节的主机地址组成，网络地址的最高位必须是“10”，

地址范围：128.1.0.1-191.255.255.254

子网掩码：255.255.0.0

二进制表示为：10000000 00000001 00000000 00000001 - 10111111 11111111 11111111 11111110

可用的B类网络有16384个，每个网络支持的最大主机数为256的2次方-2=65534台。

### C类地址

一个C类IP地址由3字节的网络地址和1字节的主机地址组成，网络地址的最高位必须是“110”

范围：192.0.1.1-223.255.255.254

子网掩码：255.255.255.0

二进制表示为: 11000000 00000000 00000001 00000001 - 11011111 11111111 11111110 11111110

C类网络可达2097152个，每个网络支持的最大主机数为256-2=254台

### D类地址

D类IP地址第一个字节以“1110”开始，它是一个专门保留的地址，并不指向特定的网络，目前这一类地址被用在多点广播（Multicast）中。

### E类地址

以“1111”开始，为将来使用保留，仅作实验和开发用。

### 私有地址

在这么多网络IP中，国际规定有一部分IP地址是用于我们的局域网使用，也就是属于私网IP，不在公网中使用的，它们的范围是：

```python
10.0.0.0～10.255.255.255
172.16.0.0～172.31.255.255
192.168.0.0～192.168.255.255
```

### 注意事项

1. 每一个字节都为0的地址（“0.0.0.0”）对应于当前主机。
2. IP地址中的每一个字节都为1的IP地址（“255．255．255．255”）是当前子网的广播地址。
3. IP地址中凡是以“1111”开头的E类IP地址都保留用于将来和实验使用。
4. IP地址中不能以十进制“127”作为开头，该类地址中数字127．0．0．1到127．255．255．255用于回路测试，如：127.0.0.1可以代表本机IP地址，用 `http://127.0.0.1` 就可以测试本机中配置的Web服务器
5. 网络ID的第一个8位组也不能全置为“0”，全“0”表示本地网络。

#socket模块

在 Python 中 使用socket 模块的函数 socket 就可以完成：

```python
import socket
socket.socket(AddressFamily, Type)
Copy
```

##说明：

函数 socket.socket 创建一个 socket，该函数带有两个参数：

- Address Family：可以选择 AF_INET（用于 Internet 进程间通信） 或者 AF_UNIX（用于同一台机器进程间通信）,实际工作中常用AF_INET
- Type：套接字类型，可以是 SOCK_STREAM（流式套接字，主要用于 TCP 协议）或者 SOCK_DGRAM（数据报套接字，主要用于 UDP 协议）

##UDP协议

```python
import socket

myudp = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

#绑定自己的端口
myudp.bind(('0.0.0.0', 8888))
#发送到的地址，127.0.0.1表示自己
address = ("127.0.0.1", 8888)
myudp.sendto('Are you happy for leaving me。'.encode("utf-8"), address)
ok = 1
while 1:
    data, addr = myudp.recvfrom(1024)
    # 接收到的信息是一个元组，第一个数据是对方发的数据。
    # 第二个信息也是元组，得到对方的ip和端口号
    # recv只会接受data
    print(data.decode('utf-8'), addr)
    # 退出循环接收
    if ok: break
myudp.close()
```

## TCP协议

发送代码

```python
import socket

socme = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

socme.connect(('127.0.0.1', 9999))

socme.send('hi'.encode('utf-8'))

socme.close()

```

接收代码

```python
import socket

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

sock.bind(('0.0.0.0', 9999))

sock.listen(50)

# 拆包
data, addr = sock.accept()
msg = data.recv(1024).decode('utf-8')
ipme, ans = addr
print('ip：{}端口：{}，发送了{}'.format(ipme, ans, msg))

```

